[gd_scene load_steps=16 format=3 uid="uid://blyl7uokcly77"]

[ext_resource type="PackedScene" uid="uid://dke3fxq26hv5k" path="res://assets/blend_files/cinematic_enemy.blend" id="1_mk1ul"]
[ext_resource type="Script" path="res://src/actors/cinematics/cinematic_enemy.gd" id="2_adg2y"]
[ext_resource type="PackedScene" uid="uid://cien5ag7i3qtf" path="res://assets/blend_files/low_poly_katana.blend" id="3_51mnw"]
[ext_resource type="PackedScene" uid="uid://yi11ph1objce" path="res://src/objects/flaming_orb.tscn" id="4_na1k7"]
[ext_resource type="Script" path="res://addons/godot_state_charts/state_chart.gd" id="5_fxgv1"]
[ext_resource type="Script" path="res://addons/godot_state_charts/compound_state.gd" id="6_c1lto"]
[ext_resource type="Script" path="res://addons/godot_state_charts/atomic_state.gd" id="7_d2ip8"]
[ext_resource type="Script" path="res://addons/godot_state_charts/transition.gd" id="8_deeoo"]

[sub_resource type="CylinderShape3D" id="CylinderShape3D_anivt"]

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_ic83x"]
albedo_color = Color(1, 0, 0, 1)

[sub_resource type="SphereMesh" id="SphereMesh_apoih"]
material = SubResource("StandardMaterial3D_ic83x")
radius = 0.1
height = 0.2

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_7pdr7"]
albedo_color = Color(1, 0, 0, 1)

[sub_resource type="BoxMesh" id="BoxMesh_f2u70"]
material = SubResource("StandardMaterial3D_7pdr7")
size = Vector3(0.178, 0.481, 0.1)

[sub_resource type="BoxMesh" id="BoxMesh_cjhop"]
material = SubResource("StandardMaterial3D_7pdr7")
size = Vector3(0.136, 0.148, 0.1)

[sub_resource type="BoxMesh" id="BoxMesh_iulsx"]
material = SubResource("StandardMaterial3D_7pdr7")
size = Vector3(0.096, 0.175, 0.1)

[node name="CinematicEnemy" node_paths=PackedStringArray("state_chart", "animation_player", "flaming_orb") instance=ExtResource("1_mk1ul")]
script = ExtResource("2_adg2y")
state_chart = NodePath("StateChart")
animation_player = NodePath("AnimationPlayer")
flaming_orb = NodePath("Armature/GeneralSkeleton/FlamingOrbBoneAttachment3D/FlamingOrb")

[node name="CollisionShape3D" type="CollisionShape3D" parent="." index="0"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 1, 0)
shape = SubResource("CylinderShape3D_anivt")
disabled = true

[node name="GeneralSkeleton" parent="Armature" index="0"]
bones/1/position = Vector3(-1.53857e-09, 1.07722, -0.0139511)
bones/1/rotation = Quaternion(-0.00697782, -0.0289302, 0.0168821, 0.999415)
bones/2/rotation = Quaternion(-0.00373666, 0.0168085, 0.00305464, 0.999847)
bones/3/rotation = Quaternion(-0.00738393, 0.0367386, 0.00861766, 0.999261)
bones/4/rotation = Quaternion(-0.00738393, 0.0367386, 0.00861766, 0.999261)
bones/5/rotation = Quaternion(-0.0148232, -0.0186335, -0.0430641, 0.998789)
bones/6/rotation = Quaternion(-0.00739373, -0.0201702, 0.00483875, 0.999758)
bones/8/rotation = Quaternion(0.433569, 0.576989, 0.514513, -0.46301)
bones/9/rotation = Quaternion(-0.1157, 0.950794, 0.287163, -0.0119087)
bones/10/rotation = Quaternion(0.0975295, -0.773076, -0.0248061, 0.626279)
bones/11/rotation = Quaternion(0.269241, 0.547423, -0.0460471, 0.791023)
bones/12/rotation = Quaternion(-0.0718547, 0.00326028, -0.030155, 0.996954)
bones/13/rotation = Quaternion(-0.0981172, 0.740182, 0.27042, 0.607764)
bones/14/rotation = Quaternion(-0.0413672, 0.0619854, -0.0694301, 0.994799)
bones/15/rotation = Quaternion(0, 2.98023e-08, -2.98023e-08, 1)
bones/16/rotation = Quaternion(-0.113222, 0.0722887, 0.104731, 0.985387)
bones/17/rotation = Quaternion(-0.412336, -0.0618467, 0.142921, 0.897623)
bones/18/rotation = Quaternion(0.0904397, -0.0104393, -0.0434863, 0.994897)
bones/20/rotation = Quaternion(-0.273625, 0.154903, 0.166979, 0.93448)
bones/21/rotation = Quaternion(-0.47508, -0.0298927, 0.107333, 0.87286)
bones/22/rotation = Quaternion(0.117396, -0.0162831, -0.0345805, 0.992349)
bones/23/rotation = Quaternion(5.96046e-08, 0, 0, 1)
bones/24/rotation = Quaternion(-0.338611, 0.163006, 0.130951, 0.9174)
bones/25/rotation = Quaternion(-0.421507, -0.0129907, 0.0714999, 0.903908)
bones/26/rotation = Quaternion(0.164516, -0.0232742, -0.0308792, 0.985616)
bones/27/rotation = Quaternion(-2.98023e-08, 2.98023e-08, 2.98023e-08, 1)
bones/28/rotation = Quaternion(-0.327623, 0.118523, 0.0442443, 0.9363)
bones/29/rotation = Quaternion(-0.330001, -0.0563399, 0.110091, 0.935845)
bones/30/rotation = Quaternion(-0.0148644, -0.0143263, 0.00966108, 0.99974)
bones/31/rotation = Quaternion(1.49012e-08, 0, 2.98023e-08, 1)
bones/32/rotation = Quaternion(0.447543, -0.561865, -0.526428, -0.454849)
bones/33/rotation = Quaternion(-0.091117, 0.947548, 0.222988, 0.210063)
bones/34/rotation = Quaternion(0.134414, 0.634882, 0.0077114, 0.760788)
bones/35/rotation = Quaternion(0.24326, -0.553784, 0.188269, 0.773759)
bones/36/rotation = Quaternion(-0.0545068, -0.0797354, 0.0422538, 0.994428)
bones/37/rotation = Quaternion(-0.210887, -0.657363, -0.427067, 0.583964)
bones/38/rotation = Quaternion(-0.0450208, -0.0520332, 0.0775401, 0.994612)
bones/39/rotation = Quaternion(-2.98023e-08, 2.98023e-08, 0, 1)
bones/40/rotation = Quaternion(-0.216098, -0.0186437, -0.10525, 0.970503)
bones/41/rotation = Quaternion(-0.516544, 0.0941133, -0.155098, 0.836821)
bones/42/rotation = Quaternion(0.0380153, 0.00717448, 0.0180159, 0.999089)
bones/43/rotation = Quaternion(0, -1.49012e-08, 0, 1)
bones/44/rotation = Quaternion(-0.327107, -0.136639, -0.172011, 0.919099)
bones/45/rotation = Quaternion(-0.464565, 0.0214627, -0.033322, 0.884651)
bones/46/rotation = Quaternion(0.0387645, 0.00606541, 0.00776374, 0.9992)
bones/47/rotation = Quaternion(2.98023e-08, -2.98023e-08, 2.98023e-08, 1)
bones/48/rotation = Quaternion(-0.192648, -0.162294, -0.126056, 0.959509)
bones/49/rotation = Quaternion(-0.542286, 0.0510988, -0.110641, 0.831308)
bones/50/rotation = Quaternion(0.0728789, 0.0119278, 0.0126207, 0.99719)
bones/51/rotation = Quaternion(0, 0, -5.96046e-08, 1)
bones/52/rotation = Quaternion(-0.254396, -0.181043, -0.189755, 0.930859)
bones/53/rotation = Quaternion(-0.44672, 0.0264323, -0.135381, 0.883977)
bones/54/rotation = Quaternion(0.0148708, 0.0149775, -0.000569701, 0.999777)
bones/56/rotation = Quaternion(0.0177596, -0.372713, 0.926958, -0.0389781)
bones/57/rotation = Quaternion(0.0138468, 0.980514, 0.194495, 0.0239134)
bones/58/rotation = Quaternion(-0.0424352, 0.750148, -0.658667, 0.0404531)
bones/59/rotation = Quaternion(-0.0246831, 0.994728, -0.0932936, -0.0346798)
bones/61/rotation = Quaternion(-0.116612, 0.112688, 0.985855, 0.0423516)
bones/62/rotation = Quaternion(0.0438671, 0.962787, 0.251271, 0.0893314)
bones/63/rotation = Quaternion(0.0975708, 0.775957, -0.619131, -0.071048)
bones/64/rotation = Quaternion(0.0197582, 0.969242, -0.245313, 0.00120756)

[node name="KatanaBoneAttachment3D" type="BoneAttachment3D" parent="Armature/GeneralSkeleton" index="1"]
transform = Transform3D(0.514397, -0.818032, 0.257332, -0.260116, -0.434778, -0.862153, 0.817151, 0.376553, -0.436432, 0.421035, 1.32352, -0.421818)
bone_name = "RightHand"
bone_idx = 35

[node name="low_poly_katana" parent="Armature/GeneralSkeleton/KatanaBoneAttachment3D" index="0" instance=ExtResource("3_51mnw")]
transform = Transform3D(-0.00382395, -0.0245554, -0.00272204, 0.0202638, -0.00154157, -0.0145603, 0.0141335, -0.00443349, 0.0201392, -0.142768, -0.0470836, 0.0787074)

[node name="FlamingOrbBoneAttachment3D" type="BoneAttachment3D" parent="Armature/GeneralSkeleton" index="2"]
transform = Transform3D(0.46518, 0.883753, 0.0508737, -0.41329, 0.267647, -0.870377, -0.782815, 0.383856, 0.48975, -0.44661, 1.06124, 0.0609117)
bone_name = "LeftHand"
bone_idx = 11

[node name="FlamingOrb" parent="Armature/GeneralSkeleton/FlamingOrbBoneAttachment3D" index="0" instance=ExtResource("4_na1k7")]
transform = Transform3D(1, 3.72532e-08, 1.9744e-06, -3.72529e-08, 1, -1.67639e-07, -1.9744e-06, 1.67639e-07, 1, 0.0340272, 0.00333089, 0.174684)
visible = false

[node name="Icosphere_002_0" parent="Armature/GeneralSkeleton/FlamingOrbBoneAttachment3D/FlamingOrb/Sketchfab_model/root/GLTF_SceneRootNode" index="0"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0)

[node name="Icosphere_001_1" parent="Armature/GeneralSkeleton/FlamingOrbBoneAttachment3D/FlamingOrb/Sketchfab_model/root/GLTF_SceneRootNode" index="1"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0)

[node name="LeftFootBoneAttachment3D" type="BoneAttachment3D" parent="Armature/GeneralSkeleton" index="3"]
transform = Transform3D(-0.998769, 0.0484155, 0.0107922, -0.0127794, -0.461373, 0.887114, 0.0479294, 0.885885, 0.461423, -0.15379, 0.171735, -0.49453)
bone_name = "LeftFoot"
bone_idx = 58

[node name="MeshInstance3D" type="MeshInstance3D" parent="Armature/GeneralSkeleton/LeftFootBoneAttachment3D" index="0"]
layers = 524288
mesh = SubResource("SphereMesh_apoih")

[node name="RightFootBoneAttachment3D" type="BoneAttachment3D" parent="Armature/GeneralSkeleton" index="4"]
transform = Transform3D(-0.999869, -0.00734791, 0.014433, 0.00917958, 0.477081, 0.878811, -0.0133431, 0.878829, -0.476951, 0.0980997, 0.161832, 0.464039)
bone_name = "RightFoot"
bone_idx = 63

[node name="MeshInstance3D" type="MeshInstance3D" parent="Armature/GeneralSkeleton/RightFootBoneAttachment3D" index="0"]
layers = 524288
mesh = SubResource("SphereMesh_apoih")

[node name="SpineBoneAttachment3D" type="BoneAttachment3D" parent="Armature/GeneralSkeleton" index="5"]
transform = Transform3D(0.998927, -0.0391312, -0.0247666, 0.0396707, 0.998978, 0.0216798, 0.023893, -0.022639, 0.999458, -0.00514446, 1.21378, -0.00579774)
bone_name = "Spine"
bone_idx = 2

[node name="MeshInstance3D" type="MeshInstance3D" parent="Armature/GeneralSkeleton/SpineBoneAttachment3D" index="0"]
layers = 524288
mesh = SubResource("BoxMesh_f2u70")

[node name="HeadBoneAttachment3D" type="BoneAttachment3D" parent="Armature/GeneralSkeleton" index="6"]
transform = Transform3D(0.999125, -0.00281422, 0.0417223, -0.00148991, 0.994704, 0.102772, -0.0417905, -0.102745, 0.99383, -0.0352511, 1.85392, -0.00862457)
bone_name = "Head"
bone_idx = 6

[node name="MeshInstance3D" type="MeshInstance3D" parent="Armature/GeneralSkeleton/HeadBoneAttachment3D" index="0"]
layers = 524288
mesh = SubResource("BoxMesh_cjhop")

[node name="LeftLegBoneAttachment3D" type="BoneAttachment3D" parent="Armature/GeneralSkeleton" index="7"]
transform = Transform3D(0.992659, 0.112416, -0.0446183, 0.120909, -0.931486, 0.343094, -0.00299223, -0.34597, -0.938241, -0.130662, 0.5501, -0.34397)
bone_name = "LeftLowerLeg"
bone_idx = 57

[node name="MeshInstance3D" type="MeshInstance3D" parent="Armature/GeneralSkeleton/LeftLegBoneAttachment3D" index="0"]
layers = 524288
mesh = SubResource("BoxMesh_iulsx")

[node name="RightLegBoneAttachment3D" type="BoneAttachment3D" parent="Armature/GeneralSkeleton" index="8"]
transform = Transform3D(0.966936, -0.254608, 0.0144962, -0.181718, -0.727769, -0.661311, 0.178925, 0.63681, -0.749972, 0.134232, 0.476131, 0.206517)
bone_name = "RightLowerLeg"
bone_idx = 62

[node name="MeshInstance3D" type="MeshInstance3D" parent="Armature/GeneralSkeleton/RightLegBoneAttachment3D" index="0"]
layers = 524288
mesh = SubResource("BoxMesh_iulsx")

[node name="LeftHandBoneAttachment3D" type="BoneAttachment3D" parent="Armature/GeneralSkeleton" index="9"]
transform = Transform3D(0.46518, 0.883753, 0.0508737, -0.41329, 0.267647, -0.870377, -0.782815, 0.383856, 0.48975, -0.44661, 1.06124, 0.0609117)
bone_name = "LeftHand"
bone_idx = 11

[node name="MeshInstance3D" type="MeshInstance3D" parent="Armature/GeneralSkeleton/LeftHandBoneAttachment3D" index="0"]
transform = Transform3D(0.931436, -0.21993, 0.289926, 0.35465, 0.72714, -0.587785, -0.0815451, 0.650307, 0.755282, 0, 0, 0)
layers = 524288
mesh = SubResource("BoxMesh_iulsx")

[node name="RightHandBoneAttachment3D" type="BoneAttachment3D" parent="Armature/GeneralSkeleton" index="10"]
transform = Transform3D(0.514397, -0.818032, 0.257332, -0.260116, -0.434778, -0.862153, 0.817151, 0.376553, -0.436432, 0.421035, 1.32352, -0.421818)
bone_name = "RightHand"
bone_idx = 35

[node name="MeshInstance3D" type="MeshInstance3D" parent="Armature/GeneralSkeleton/RightHandBoneAttachment3D" index="0"]
transform = Transform3D(0.931436, 0.21993, -0.289926, -0.35465, 0.72714, -0.587785, 0.0815451, 0.650307, 0.755282, 0, 0, 0)
layers = 524288
mesh = SubResource("BoxMesh_iulsx")

[node name="StateChart" type="Node" parent="." index="2"]
script = ExtResource("5_fxgv1")

[node name="States" type="Node" parent="StateChart" index="0"]
script = ExtResource("6_c1lto")
initial_state = NodePath("Walking")

[node name="Walking" type="Node" parent="StateChart/States" index="0"]
script = ExtResource("7_d2ip8")

[node name="ToStanding" type="Node" parent="StateChart/States/Walking" index="0"]
script = ExtResource("8_deeoo")
to = NodePath("../../Standing")
delay_seconds = 6.2

[node name="Standing" type="Node" parent="StateChart/States" index="1"]
script = ExtResource("7_d2ip8")

[node name="ToWaiting" type="Node" parent="StateChart/States/Standing" index="0"]
script = ExtResource("8_deeoo")
to = NodePath("../../Waiting")
event = &"FightStarted"
delay_seconds = 3.0

[node name="Waiting" type="Node" parent="StateChart/States" index="2"]
script = ExtResource("7_d2ip8")

[node name="ToTransform" type="Node" parent="StateChart/States/Waiting" index="0"]
script = ExtResource("8_deeoo")
to = NodePath("../../Transform")
event = &"PlayerWon"
delay_seconds = 6.0

[node name="ToWalking" type="Node" parent="StateChart/States/Waiting" index="1"]
script = ExtResource("8_deeoo")
to = NodePath("../../Walking")
event = &"GameBegin"

[node name="Transform" type="Node" parent="StateChart/States" index="3"]
script = ExtResource("7_d2ip8")

[node name="ToWalking" type="Node" parent="StateChart/States/Transform" index="0"]
script = ExtResource("8_deeoo")
to = NodePath("../../Walking")
delay_seconds = 6.0

[node name="AnimationPlayer" parent="." index="3"]
root_motion_track = NodePath("%GeneralSkeleton:mixamorig_Root")
callback_mode_process = 0
playback_default_blend_time = 2.0

[node name="RootMotionView" type="RootMotionView" parent="." index="4"]
animation_path = NodePath("../AnimationPlayer")

[connection signal="state_entered" from="StateChart/States/Walking" to="." method="_on_walking_state_entered"]
[connection signal="state_entered" from="StateChart/States/Standing" to="." method="_on_standing_state_entered"]
[connection signal="state_exited" from="StateChart/States/Standing" to="." method="_on_standing_state_exited"]
[connection signal="state_entered" from="StateChart/States/Waiting" to="." method="_on_waiting_state_entered"]
[connection signal="state_exited" from="StateChart/States/Waiting" to="." method="_on_waiting_state_exited"]
[connection signal="state_entered" from="StateChart/States/Transform" to="." method="_on_transform_state_entered"]

[editable path="Armature/GeneralSkeleton/FlamingOrbBoneAttachment3D/FlamingOrb"]
